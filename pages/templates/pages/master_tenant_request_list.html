{% extends "pages/base.html" %}
{% block title %}ìš”ì²­ ê´€ë¦¬{% endblock %}

{% load static %}

{% block content %}
<style>
  .selected {
    border-color: var(--selected-row) !important;
    background-color: var(--selected-row-bg) !important;
  }
  .request-label{
    width: 180px;
  }
  .request-value{
    width: 200px !important;
    flex: none !important;
    /* text-align: right !important; */
  }
  .form-group-left{
    margin-bottom: 13px;
  }
</style>

<div class="page-title">
  <div style="display: flex; align-items: center;">
    <div class="gradient-bar"></div>
    <div>ìš”ì²­ ê´€ë¦¬</div>
  </div>
</div>


<div style="display: flex; gap: 20px; min-height: 80%;">
  <div style="flex: 0.4; padding: 0 20px;">
    <h3>ìš”ì²­ ëª©ë¡</h3>
    <div class="table-container">
      {% if tenantreqs %}
        <table class="table table-bordered table-sm">
          <thead>
            <tr>
            <th style="width: 15%;">ìš”ì²­ì¼ì‹œ</th>
            <th style="width: 17%;">ì‚¬ì—…ì<br>ë“±ë¡ë²ˆí˜¸</th>
            <th style="width: 18%;">ì‚¬ì—…ìëª…</th>
            <th style="width: 12%;">ê³¼ê¸ˆ<br>ì‚¬ìš©ììˆ˜</th>
          </tr>
        </thead>
        <tbody>
            {% for tenantreq in tenantreqs %}
            <tr class="tenantreqs"
                data-tenantrequid="{{ tenantreq.tenantrequid }}"
                data-bizregno="{{ tenantreq.bizregno }}"
                data-tenantnm="{{ tenantreq.tenantnm }}"
                data-billingusercnt="{{ tenantreq.billingusercnt }}"
                data-llmlimityn="{{ tenantreq.llmlimityn|yesno:'âˆš,-' }}"
                data-managernm="{{ tenantreq.managernm }}"
                data-managerdepart="{{ tenantreq.managerdepart }}"
                data-managerposition="{{ tenantreq.managerposition }}"
                data-email="{{ tenantreq.email }}"
                data-telno="{{ tenantreq.telno }}"
                data-bizregfilenm="{{ tenantreq.bizregfilenm }}"
                data-bizregfileurl="{{ tenantreq.bizregfileurl }}"
                data-creator="{{ tenantreq.creator }}"
                data-createdts="{{ tenantreq.createdts }}">
              <td class="info" >{{ tenantreq.createdts|default_if_none:'' }}</td>
              <td class="info" >{{ tenantreq.bizregno|default_if_none:'' }}</td>
              <td class="info" >{{ tenantreq.tenantnm|default_if_none:'' }}</td>
              <td class="info" >{{ tenantreq.billingusercnt|default_if_none:'0' }}</td>
            </tr>
            {% endfor %}
        </tbody>
      </table>
      {% endif %}
    </div>
  </div>

  <!-- ìš°ì¸¡ íŒ¨ë„ -->
  <div style="flex: 0.7; padding-left: 20px;">
    <h3>ìš”ì²­ ìƒì„¸</h3>
    <div>
      <input type="hidden" id="tenantrequid" name="tenantrequid" />

      <div class="form-group-left">
        <span class="request-label">ìš”ì²­ì¼ì‹œ</span>
        <div class="request-value">
          <input class="request-value" style="text-align: right;" type="text" id="createdts" name="createdts" disabled>
        </div>
      </div>

      <div class="form-group-left">
        <span class="request-label">ì‚¬ìš©ììˆ˜</span>
        <div class="request-value">
          <input class="request-value" style="text-align: right;" type="text" id="billingusercnt" name="billingusercnt" disabled>
        </div>
      </div>

      <div class="form-group-left">
        <span class="request-label">LLMì‚¬ìš©ì œí•œì—¬ë¶€</span>
        <div class="request-value">
          <input class="request-value" style="text-align: right;" type="text" id="llmlimityn" name="llmlimityn" disabled>
        </div>
      </div>

      <div class="form-group-left">
        <div class="info-left" style="align-self: flex-start;">
          <h3>ê¸°ì—… ì •ë³´</h3>
          <!-- ê¸°ì—… ì •ë³´ ì‹œì‘ -->
          <div class="tenant-info">
            <div class="form-group-left">
              <label class="request-label">íšŒì‚¬(ë²•ì¸) ëª…ì¹­:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="text" id="tenantnm" name="tenantnm" disabled>
              </div>
            </div>

            <div class="form-group-left">
              <label class="request-label">ë²•ì¸(ì‚¬ì—…ì) ë“±ë¡ë²ˆí˜¸:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="text" id="bizregno" name="bizregno"  disabled>
              </div>
            </div>

            <div style="margin-top: 10px;">
              <input type="file" id="bizregfile" name="bizregfile" style="display:none">

              <!-- í˜„ì¬ íŒŒì¼ ë° ì—…ë¡œë“œ ë²„íŠ¼ -->
              <div style="display:none; align-items:center; gap:10px;">
                <button type="button" id="upload-btn" class="icon-btn">
                <img src="{% static 'icons/upload.svg' %}" title="ì—…ë¡œë“œ" class="icon-img new-icon">
                </button>
                <span id="current-bizregfile">ì‚¬ì—…ì ë“±ë¡ì¦ ì‚¬ë³¸ íŒŒì¼ ì—†ìŒ</span>
              </div>
            </div>

          </div>
        </div>
        <!-- ê¸°ì—… ì •ë³´ ì¢…ë£Œ -->

        <div class="info-right" style="align-self: flex-start; margin-left: 200px;">
          <h3>ì„œë¹„ìŠ¤ ë‹´ë‹¹ì ì •ë³´</h3>
          <!-- ì„œë¹„ìŠ¤ ë‹´ë‹¹ì ì •ë³´ ì‹œì‘ -->
          <div class="manager-info" >
            <div class="form-group-left">
              <label class="request-label">ì„±ëª…:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="text" id="managernm" name="managernm" disabled>
              </div>
            </div>

            <div class="form-group-left">
              <label class="request-label">ë¶€ì„œ:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="text" id="managerdepart" name="managerdepart" disabled>
              </div>
            </div>

            <div class="form-group-left">
              <label class="request-label">ì§ì±…:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="text" id="managerposition" name="managerposition" disabled>
              </div>
            </div>

            <div class="form-group-left">
              <label class="request-label">ì´ë©”ì¼ì£¼ì†Œ:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="email" id="email" name="email" disabled>
              </div>
            </div>

            <div class="form-group-left">
              <label class="request-label">ì „í™”ë²ˆí˜¸:</label>
              <div class="request-value">
                <input class="request-value" style="text-align: right;" type="tel" id="telno" name="telno" disabled>
              </div>
            </div>
            
          </div>
        </div>
        <!-- ì„œë¹„ìŠ¤ ë‹´ë‹¹ì ì •ë³´ ì¢…ë£Œ -->
      </div>
    </div>
  </div>
</div>

<script>

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
});


document.querySelectorAll(".tenantreqs").forEach(tenantreq => {
  tenantreq.addEventListener("click", function () {
    // console.log("ì„ íƒ")
    // ğŸ”¹ ê¸°ì¡´ ì„ íƒ ì œê±°
    document.querySelectorAll(".tenantreqs").forEach(c => c.classList.remove("selected"));

    // ğŸ”¹ í˜„ì¬ ì„ íƒ ì¹´ë“œ ê°•ì¡°
    this.classList.add("selected");

    const tenantrequid = this.dataset.tenantrequid;
    const bizregno = this.dataset.bizregno;
    const tenantnm = this.dataset.tenantnm;
    const billingusercnt = this.dataset.billingusercnt;
    const llmlimityn = this.dataset.llmlimityn;
    const managernm = this.dataset.managernm;
    const managerdepart = this.dataset.managerdepart;
    const managerposition = this.dataset.managerposition;
    const email = this.dataset.email;
    const telno = this.dataset.telno;
    const bizregfilenm = this.dataset.bizregfilenm;
    const bizregfileurl = this.dataset.bizregfileurl;
    const creator = this.dataset.creator;
    const creatornm = this.dataset.creatornm;
    const createdts = this.dataset.createdts;

    document.getElementById("tenantrequid").value = tenantrequid;
    document.getElementById("bizregno").value = bizregno;
    document.getElementById("tenantnm").value = tenantnm;
    document.getElementById("billingusercnt").value = billingusercnt;
    document.getElementById("llmlimityn").value = llmlimityn;
    document.getElementById("managernm").value = managernm;
    document.getElementById("managerdepart").value = managerdepart;
    document.getElementById("managerposition").value = managerposition;
    document.getElementById("email").value = email;
    document.getElementById("telno").value = telno;
    document.getElementById("createdts").value = createdts;

  })
})

</script>
{% endblock %}